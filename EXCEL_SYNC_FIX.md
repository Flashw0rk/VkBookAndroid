# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Excel —Ñ–∞–π–ª–æ–≤

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
Excel —Ñ–∞–π–ª `Armatures.xlsx` –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É ArmatureFragment –ø—Ä–æ–¥–æ–ª–∂–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.

## üîç –ü—Ä–∏—á–∏–Ω–∞
1. **SyncService** —Å–æ—Ö—Ä–∞–Ω—è–ª Excel —Ñ–∞–π–ª—ã –≤ `context.filesDir/Databases/`
2. **RemoteFileProvider** –∏—Å–∫–∞–ª —Ñ–∞–π–ª—ã –≤ `context.cacheDir/remote_cache/`
3. **ExcelRepository** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª RemoteFileProvider –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
4. –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, –∞ —á–∏—Ç–∞–ª–∏—Å—å –∏–∑ –¥—Ä—É–≥–æ–≥–æ

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω SyncService
```kotlin
// –¢–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
val cacheDir = File(context.cacheDir, "remote_cache")
cacheDir.mkdirs()
val file = File(cacheDir, filename.replace('/', '_'))
```

### 2. –£–ª—É—á—à–µ–Ω RemoteFileProvider
```kotlin
// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
if (cached.exists() && cached.length() > 0) {
    Log.d("RemoteFileProvider", "Using cached file: ${cached.absolutePath}")
    return cached.inputStream()
}
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –≤ ArmatureFragment
```kotlin
private fun clearExcelCache() {
    val cacheDir = File(requireContext().cacheDir, "excel_cache")
    if (cacheDir.exists()) {
        cacheDir.deleteRecursively()
    }
}
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
1. ‚úÖ Excel —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞
2. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
3. ‚úÖ ArmatureFragment —á–∏—Ç–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. ‚úÖ –ö—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
5. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã –≤ —Å–ø–∏—Å–∫–µ

## üì± –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–∂–º–∏—Ç–µ "üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è"
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ê—Ä–º–∞—Ç—É—Ä–∞"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–∏–ª—Å—è
5. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∞—Ä–º–∞—Ç—É—Ä—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—Ö–µ–º—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º

## üîç –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ò—â–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
- `SyncService: Downloaded Excel file: Armatures.xlsx`
- `RemoteFileProvider: Using cached file`
- `ArmatureFragment: Excel cache cleared`
- `ArmatureFragment: Loaded X markers from server`

---

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! Excel —Ñ–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.** üéâ
