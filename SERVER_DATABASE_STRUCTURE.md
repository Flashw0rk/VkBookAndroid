# üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ VkBook Server**

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```
/var/www/vkbook-server/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ databases/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ armature/                    # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–º–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ armature_coords.json    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞—Ä–º–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ armature_markers.json   # –ú–∞—Ä–∫–µ—Ä—ã –∞—Ä–º–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ armature_versions.json  # –í–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemes/                     # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemes_list.json       # –°–ø–∏—Å–æ–∫ —Å—Ö–µ–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemes_metadata.json   # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ö–µ–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemes_versions.json   # –í–µ—Ä—Å–∏–∏ —Å—Ö–µ–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signals/                     # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ signals_data.json       # –î–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ signals_metadata.json   # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ signals_versions.json   # –í–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ files/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ excel/                      # Excel —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ armature/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signals/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf/                        # PDF —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ armature/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signals/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ images/                     # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ armature/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ schemes/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ signals/
‚îÇ   ‚îî‚îÄ‚îÄ metadata/
‚îÇ       ‚îú‚îÄ‚îÄ file_versions.json          # –í–µ—Ä—Å–∏–∏ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ update_log.json             # –õ–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ server_info.json            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ
```

## üîÑ **API Endpoints –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:**
```
GET /api/updates/check
Response: {
  "hasUpdates": true,
  "lastUpdate": "2025-09-16T10:30:00Z",
  "files": [
    {
      "type": "armature",
      "filename": "armature_coords.json",
      "version": "1.2.3",
      "size": 1024,
      "hash": "sha256:abc123...",
      "lastModified": "2025-09-16T10:30:00Z"
    }
  ]
}
```

### **2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤:**
```
GET /api/files/list?type=armature
Response: {
  "success": true,
  "data": [
    {
      "filename": "armature_coords.json",
      "version": "1.2.3",
      "size": 1024,
      "hash": "sha256:abc123...",
      "lastModified": "2025-09-16T10:30:00Z",
      "downloadUrl": "/api/files/download?filename=armature_coords.json"
    }
  ]
}
```

### **3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞:**
```
GET /api/files/download?filename=armature_coords.json
Response: File content
```

### **4. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
```
GET /api/metadata/versions
Response: {
  "armature": {
    "version": "1.2.3",
    "lastUpdate": "2025-09-16T10:30:00Z",
    "files": ["armature_coords.json", "armature_markers.json"]
  },
  "schemes": {
    "version": "2.1.0",
    "lastUpdate": "2025-09-15T15:20:00Z",
    "files": ["schemes_list.json"]
  },
  "signals": {
    "version": "1.0.5",
    "lastUpdate": "2025-09-14T09:15:00Z",
    "files": ["signals_data.json"]
  }
}
```

## üìù **–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**

### **file_versions.json:**
```json
{
  "armature": {
    "armature_coords.json": {
      "version": "1.2.3",
      "size": 1024,
      "hash": "sha256:abc123...",
      "lastModified": "2025-09-16T10:30:00Z",
      "description": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞—Ä–º–∞—Ç—É—Ä—ã"
    }
  },
  "schemes": {
    "schemes_list.json": {
      "version": "2.1.0",
      "size": 2048,
      "hash": "sha256:def456...",
      "lastModified": "2025-09-15T15:20:00Z",
      "description": "–ù–æ–≤—ã–µ —Å—Ö–µ–º—ã"
    }
  },
  "signals": {
    "signals_data.json": {
      "version": "1.0.5",
      "size": 512,
      "hash": "sha256:ghi789...",
      "lastModified": "2025-09-14T09:15:00Z",
      "description": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã"
    }
  }
}
```

### **update_log.json:**
```json
{
  "updates": [
    {
      "timestamp": "2025-09-16T10:30:00Z",
      "type": "armature",
      "filename": "armature_coords.json",
      "version": "1.2.3",
      "action": "update",
      "description": "–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞—Ä–º–∞—Ç—É—Ä—ã"
    },
    {
      "timestamp": "2025-09-15T15:20:00Z",
      "type": "schemes",
      "filename": "schemes_list.json",
      "version": "2.1.0",
      "action": "update",
      "description": "–û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ö–µ–º—ã"
    }
  ]
}
```

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:**

### **1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:**
```bash
sudo mkdir -p /var/www/vkbook-server/data/{databases,files,metadata}
sudo mkdir -p /var/www/vkbook-server/data/databases/{armature,schemes,signals}
sudo mkdir -p /var/www/vkbook-server/data/files/{excel,pdf,images}
sudo mkdir -p /var/www/vkbook-server/data/files/excel/{armature,schemes,signals}
sudo mkdir -p /var/www/vkbook-server/data/files/pdf/{armature,schemes,signals}
sudo mkdir -p /var/www/vkbook-server/data/files/images/{armature,schemes,signals}
```

### **2. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
```bash
sudo chown -R www-data:www-data /var/www/vkbook-server/data
sudo chmod -R 755 /var/www/vkbook-server/data
```

### **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
```java
@CrossOrigin(origins = "*")
@RestController
public class FileController {
    // –í–∞—à–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
}
```

## üì± **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

### **1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ VkBookApiClient:**
```java
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
public void checkForUpdates(Callback callback) {
    Request request = new Request.Builder()
            .url(ServerConfig.API_BASE_URL + "/updates/check")
            .build();
    client.newCall(request).enqueue(callback);
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
public void getMetadata(Callback callback) {
    Request request = new Request.Builder()
            .url(ServerConfig.API_BASE_URL + "/metadata/versions")
            .build();
    client.newCall(request).enqueue(callback);
}
```

### **2. –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```kotlin
class UpdateManager {
    fun checkAndUpdate() {
        // 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
        // 2. –°—Ä–∞–≤–Ω–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏
        // 3. –°–∫–∞—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
        // 4. –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    }
}
```

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:**

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑–æ–≤—ã–µ —Ñ–∞–π–ª—ã** —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
3. **–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞**
5. **–°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö**

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```json
{
  "server_info": {
    "version": "1.0.0",
    "lastRestart": "2025-09-16T08:00:00Z",
    "uptime": "2h 30m",
    "totalRequests": 1250,
    "successfulRequests": 1200,
    "failedRequests": 50
  }
}
```

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏—Ç:
- ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–æ—Å—Ç—É—é —Å–∏—Å—Ç–µ–º—É –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å


