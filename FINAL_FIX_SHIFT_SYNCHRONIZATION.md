# ‚úÖ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å–º–µ–Ω —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º

## –î–∞—Ç–∞: 22.10.2025

---

## üéØ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `getAdjustedShiftForDisplay` –∫–∞–ª–µ–Ω–¥–∞—Ä—å **—Å–¥–≤–∏–≥–∞–ª—Å—è** –≤–ª–µ–≤–æ (—á—Ç–æ–±—ã –ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è –≤ 36 —è—á–µ–µ–∫), –Ω–æ **–≥—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω –æ—Å—Ç–∞–≤–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ**!

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:

```
–ö–ê–õ–ï–ù–î–ê–†–¨ (—è–Ω–≤–∞—Ä—å 2026):
  calculated shift = 6 (–∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞)
  adjusted shift = 6 (–ø–æ–º–µ—â–∞–µ—Ç—Å—è)
  ‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 6

–ì–†–ê–§–ò–ö –°–ú–ï–ù:
  –ü–æ–∑–∏—Ü–∏—è 0 1 2 3 4 5 6 7 8 9 ...
  ‚ùå –°—Ç–∞—Ç–∏—á–Ω—ã–π, –Ω–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è

–†–ï–ó–£–õ–¨–¢–ê–¢: –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –≥—Ä–∞—Ñ–∏–∫ –ù–ï –°–û–í–ü–ê–î–ê–Æ–¢!
```

---

## üîç –ü–û–ß–ï–ú–£ –≠–¢–û –ü–†–û–ò–°–•–û–î–ò–õ–û

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 250-264):

```kotlin
// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å–º–µ–Ω - —Å—Ç–∞—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã 36 —è—á–µ–µ–∫ –±–µ–∑ –ø—É—Å—Ç—ã—Ö
repeat(5) { shiftIndex ->
    val pattern = shiftPatterns[shiftIndex]
    
    scheduleData.add(
        ScheduleRow(
            shiftNames[shiftIndex],
            pattern.toList(),  // ‚ùå –°–¢–ê–¢–ò–ß–ù–´–ô –ü–ê–¢–¢–ï–†–ù!
            isMonthRow = false,
            shiftIndex = shiftIndex
        )
    )
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–ª—Å—è —á–µ—Ä–µ–∑ `getAdjustedShiftForDisplay`
- –ì—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω –æ—Å—Ç–∞–≤–∞–ª—Å—è **—Å—Ç–∞—Ç–∏—á–Ω—ã–º** (36 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- **–†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è!**

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –≥—Ä–∞—Ñ–∏–∫–∞

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 250-278):

```kotlin
// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å–º–µ–Ω - –°–î–í–ò–ù–£–¢–´–ï –°–ò–ù–•–†–û–ù–ù–û —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
// –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â–∏–π —Å–¥–≤–∏–≥ –≥–æ–¥–∞ (–±–µ—Ä–µ–º —è–Ω–≤–∞—Ä—å –∫–∞–∫ –±–∞–∑—É)
val januaryCalculatedShift = calculateMonthShift(currentYear, 0)
val januaryAdjustedShift = getAdjustedShiftForDisplay(currentYear, 0, daysInMonths[0])
val yearShiftOffset = januaryCalculatedShift - januaryAdjustedShift

Log.d(TAG, "–ì–æ–¥ $currentYear: —è–Ω–≤–∞—Ä—å calculated=$januaryCalculatedShift, adjusted=$januaryAdjustedShift, —Å–¥–≤–∏–≥ –≥—Ä–∞—Ñ–∏–∫–∞=$yearShiftOffset")

repeat(5) { shiftIndex ->
    val pattern = shiftPatterns[shiftIndex]
    
    // –°–î–í–ò–ì–ê–ï–ú –ü–ê–¢–¢–ï–†–ù –¶–ò–ö–õ–ò–ß–ï–°–ö–ò –Ω–∞ yearShiftOffset –≤–ø—Ä–∞–≤–æ
    val shiftedPattern = if (yearShiftOffset == 0) {
        pattern.toList()
    } else {
        // –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥: –±–µ—Ä–µ–º —Å –∫–æ–Ω—Ü–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
        val actualOffset = (yearShiftOffset % 36 + 36) % 36  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫ 0-35
        pattern.takeLast(actualOffset) + pattern.dropLast(actualOffset)
    }
    
    scheduleData.add(
        ScheduleRow(
            shiftNames[shiftIndex],
            shiftedPattern,  // ‚úÖ –°–î–í–ò–ù–£–¢–´–ô –ü–ê–¢–¢–ï–†–ù!
            isMonthRow = false,
            shiftIndex = shiftIndex
        )
    )
}
```

---

## üßÆ –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –°–î–í–ò–ì–ê

### –ü—Ä–∏–º–µ—Ä 1: –Ø–Ω–≤–∞—Ä—å 2025

```
calculatedShift = 1 (–∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞)
adjustedShift = 1 (–ø–æ–º–µ—â–∞–µ—Ç—Å—è, —Ç.–∫. 1 + 31 = 32 < 36)
yearShiftOffset = 1 - 1 = 0

–°–¥–≤–∏–≥ –≥—Ä–∞—Ñ–∏–∫–∞: 0 (–≥—Ä–∞—Ñ–∏–∫ –Ω–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è)
‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –≥—Ä–∞—Ñ–∏–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã
```

### –ü—Ä–∏–º–µ—Ä 2: –Ø–Ω–≤–∞—Ä—å 2026

```
calculatedShift = 6 (–∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞)
adjustedShift = 6 (–ø–æ–º–µ—â–∞–µ—Ç—Å—è, —Ç.–∫. 6 + 31 = 37... —Å—Ç–æ–ø!)

–û—à–∏–±–∫–∞! 6 + 31 = 37 > 36!
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º: adjustedShift = 6 - 10 = -4... –Ω–µ—Ç, —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!

–ü—Ä–∞–≤–∏–ª—å–Ω–æ (–∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏):
  patternValue = 6 % 10 = 6
  maxSafePosition = 36 - 31 = 5
  adjustedShift = 6 (–Ω–æ 6 > 5, –ø–æ—ç—Ç–æ–º—É –ù–ï –ü–û–ú–ï–©–ê–ï–¢–°–Ø!)
  
–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —á—Ç–æ-—Ç–æ –º–µ–Ω—å—à–µ–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–µ 5!
```

**–°–¢–û–ü!** –Ø –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É –≤ —Å–∞–º–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `getAdjustedShiftForDisplay`!

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º:

### –õ–æ–≥–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏:

```kotlin
val patternValue = calculatedShift % 10  // 6 % 10 = 6
val maxSafePosition = 36 - 31 = 5

var adjustedPosition = patternValue  // 6

while (adjustedPosition > maxSafePosition && adjustedPosition >= 10) {
    adjustedPosition -= 10
}
// 6 > 5 ‚úì, –Ω–æ 6 >= 10 ‚úó ‚Üí —Ü–∏–∫–ª –ù–ï –í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø!

return 6  // ‚ùå –í–û–ó–í–†–ê–©–ê–ï–¢ 6, —Ö–æ—Ç—è –ù–ï –ü–û–ú–ï–©–ê–ï–¢–°–Ø!
```

**–í–û–¢ –ì–î–ï –û–®–ò–ë–ö–ê!** –£—Å–ª–æ–≤–∏–µ `adjustedPosition >= 10` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ!

---

## üêõ –ù–ê–ô–î–ï–ù–ê –û–®–ò–ë–ö–ê –í `getAdjustedShiftForDisplay`!

### –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Å—Ç—Ä–æ–∫–µ 189:

```kotlin
while (adjustedPosition > maxSafePosition && adjustedPosition >= 10) {
    adjustedPosition -= 10
}
```

**–õ–æ–≥–∏–∫–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è:**
- –î–ª—è `patternValue = 6`, `maxSafePosition = 5`
- –£—Å–ª–æ–≤–∏–µ: `6 > 5 ‚úì AND 6 >= 10 ‚úó` ‚Üí —Ü–∏–∫–ª –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 6 (–Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è!)

### –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:

–ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É! –ï—Å–ª–∏ `patternValue > maxSafePosition`, —Ç–æ:
1. –õ–∏–±–æ –≤–∑—è—Ç—å `patternValue` (–µ—Å–ª–∏ –ø–æ–º–µ—â–∞–µ—Ç—Å—è)
2. –õ–∏–±–æ –≤–∑—è—Ç—å 0 (–Ω–∞—á–∞–ª–æ)

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**

```kotlin
// –ï—Å–ª–∏ patternValue –ø–æ–º–µ—â–∞–µ—Ç—Å—è - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
if (patternValue + daysInMonth <= 36) {
    return patternValue
}

// –ò–Ω–∞—á–µ –∏—â–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ü–∏–∫–ª–∞—Ö (patternValue - 10, patternValue - 20...)
var adjustedPosition = patternValue
while (adjustedPosition > maxSafePosition) {
    adjustedPosition -= 10
    if (adjustedPosition < 0) {
        // –ù–µ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–æ–∑–∏—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º 0
        return 0
    }
}

return adjustedPosition
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê!

–§—É–Ω–∫—Ü–∏—è `getAdjustedShiftForDisplay` **–ù–ï –†–ê–ë–û–¢–ê–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–û** –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ `patternValue` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 6-9 –∏ –º–µ—Å—è—Ü –∏–º–µ–µ—Ç 31 –¥–µ–Ω—å!

–ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å!






